"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[526],{6949:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>h,contentTitle:()=>c,default:()=>u,frontMatter:()=>l,metadata:()=>d,toc:()=>m});var s=i(4848),n=i(8453),r=i(6540),o=i(4625);const a=()=>{const[e,t]=(0,r.useState)(0);return(0,s.jsx)("div",{className:"learn-page text-left flex md:flex-row flex-col text-slate",children:(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("p",{className:"pb-4 text-justify",children:["Routing of messages on Quilibrium's network utilizes a mixnet approach called ",(0,s.jsx)("a",{href:"https://eprint.iacr.org/2022/1037",children:"RPM"}),", in which each logical cluster (clique) permutes the messages following a threshold permutation matrix scheme."]}),(0,s.jsx)("h2",{className:"text-xl pt-10 pb-4 font-medium",children:"Basics"}),(0,s.jsx)("p",{className:"pb-4 text-justify",children:"Mixnets at a simplified point of view can be thought of as a black box that takes in messages from senders, and relays them to recievers, such that an attacker with access to info outside this black box (but not within) cannot correlate the sender to the recipient. While mixnets have been around for a long time, the research on deanonymizing users has also vastly expanded in scope, and so advanced techniques have been developed to help preserve anonymity of users. The threat model can be summarized as the following types of attackers:"}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("b",{children:"External, Active"})," \u2013 the attacker introduces their own traffic to the mixnet to enhance the analysis of traffic flow, or disrupt operations to better identify individuals."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("b",{children:"External, Passive"})," \u2013 the attacker monitors traffic to and from the mixnet operators, and the exact timings of communication that occurred."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("b",{children:"Internal, Active"})," \u2013 the attacker operates as a malicious mixnet node to actively drop some amounts of traffic to distinctively identify individuals."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("b",{children:"Internal, Passive"})," \u2013 the attacker operates as a normal mixnet node to decrypt one or more hops of the traffic."]})]}),(0,s.jsxs)("p",{className:"py-4 text-justify",children:["Our approach to solving these problems is through economic ",(0,s.jsx)(o.N_,{to:"/docs/learn/operating-system/universal-resources",children:"disincentives"})," making it too expensive to broadly interrupt traffic flow at the external active attacker level, our direct routing strategy through RPM detailed further below to completely make the internal active/passive attacker models fail, as they would identify the bad actor through protocol aborts, and finally through our gossip layer ",(0,s.jsx)(o.N_,{to:"/docs/communication/gossip",children:"BlossomSub"})," to make the external passive model infeasible."]}),(0,s.jsx)("h2",{className:"text-xl pt-10 pb-4 font-medium",children:"RPM"}),(0,s.jsxs)("p",{className:"pb-4 text-justify",children:["Focusing strictly on the raw details of RPM before expanding to the full utilization on the network, RPM works through a technique of building a collection of random permutation matrix secret shares, along with Beaver triples in an offline process, then collecting input messages for distribution as secret-shared blocks from the senders, and collectively across the span of nodes participating, perform Shamir recombination and multiplication of the input vector through the MPC-derived permutation matrix, resulting in an output vector of messages which have no meaningful correlation to the originating sender that can be derived by any participant. To enhance the scalability of this process, instead of one large permutation matrix, smaller permutation matrices are generated and then arranged in a square lattice network, following the ",(0,s.jsx)("a",{href:"https://www.csc.kth.se/~johanh/jhsquare.pdf",children:"Square Lattice Shuffle"})," technique."]}),(0,s.jsx)("h2",{className:"text-xl pt-10 pb-4 font-medium",children:"A Deeper Dive"}),(0,s.jsx)("p",{className:"pb-4 text-justify",children:"The RPM protocol follows three phases in its direct implementation, however we augment it with an additional process recommended in the paper for a matched request/response scheme, resulting in five phases:"}),(0,s.jsxs)("ol",{className:"list-decimal pl-6",children:[(0,s.jsx)("li",{children:(0,s.jsx)("b",{children:"Message Collection"})}),(0,s.jsx)("li",{children:(0,s.jsx)("b",{children:"Server Permutation"})}),(0,s.jsx)("li",{children:(0,s.jsx)("b",{children:"Broadcast"})}),(0,s.jsx)("li",{children:(0,s.jsx)("b",{children:"Processing/Acknowledgement"})}),(0,s.jsx)("li",{children:(0,s.jsx)("b",{children:"Transpose Mix"})})]}),(0,s.jsx)("p",{className:"py-4 text-justify",children:"To give a visual understanding of this process in the scope of a logical clique (cluster), click the phases in the diagram below:"}),(0,s.jsxs)("div",{className:"p-6 my-6 block rounded-xl dark:bg-white/10 bg-pink-50 border border-white/20 drop-shadow-xl justify-center flex flex-col",children:[(0,s.jsx)("img",{src:"/img/docs/learn/communication/SLRP"+e+".png"}),(0,s.jsxs)("div",{className:"text-xl text-center text-black",children:[(0,s.jsx)("span",{onClick:()=>t(0),className:(0===e?"bg-pink-400 border-pink-600 ":"")+"cursor-pointer inline-block py-1 px-3 bg-slate-100 border border-slate-200 rounded-md my-2 mx-2",children:"All Phases"})," \u25b6",(0,s.jsx)("span",{onClick:()=>t(1),className:(1===e?"bg-pink-400 border-pink-600 ":"")+"cursor-pointer inline-block py-1 px-3 bg-slate-100 border border-slate-200 rounded-md my-2 mx-2",children:" Message Collection"})," \u25b6",(0,s.jsx)("span",{onClick:()=>t(2),className:(2===e?"bg-pink-400 border-pink-600 ":"")+"cursor-pointer inline-block py-1 px-3 bg-slate-100 border border-slate-200 rounded-md my-2 mx-2",children:" Server Permutation"})," \u25b6",(0,s.jsx)("span",{onClick:()=>t(3),className:(3===e?"bg-pink-400 border-pink-600 ":"")+"cursor-pointer inline-block py-1 px-3 bg-slate-100 border border-slate-200 rounded-md my-2 mx-2",children:" Broadcast"})," \u25b6",(0,s.jsx)("span",{onClick:()=>t(4),className:(4===e?"bg-pink-400 border-pink-600 ":"")+"cursor-pointer inline-block py-1 px-3 bg-slate-100 border border-slate-200 rounded-md my-2 mx-2",children:" Processing/Acknowledgement"})," \u25b6",(0,s.jsx)("span",{onClick:()=>t(5),className:(5===e?"bg-pink-400 border-pink-600 ":"")+"cursor-pointer inline-block py-1 px-3 bg-slate-100 border border-slate-200 rounded-md my-2 mx-2",children:" Transpose Mix"})]})]}),(0,s.jsx)("h2",{className:"text-xl pt-10 pb-4 font-medium",children:"Message Collection"}),(0,s.jsxs)("p",{className:"pb-4 text-justify",children:["The preparation at the client level requires the creation of a Shamir split of the message ",(0,s.jsx)("code",{children:"m"}),", that can be ordered deterministically by the servers. This is achieved by generating Shamir shares of a random value ",(0,s.jsx)("code",{children:"r"})," given out to the client, recombined by the client, and added to the message ",(0,s.jsx)("code",{children:"m + r"}),", blinding it. This message can be sent to the servers, who can subtract their share of ",(0,s.jsx)("code",{children:"r"})," and collectively recombine it in the permutation phase to find ",(0,s.jsx)("code",{children:"m"}),"."]}),(0,s.jsx)("h2",{className:"text-xl pt-10 pb-4 font-medium",children:"Server Permutation"}),(0,s.jsxs)("p",{className:"pb-4 text-justify",children:["The permutation process is performed with the input vector of blinded messages ",(0,s.jsx)("code",{children:"Y = P \xb7 (X + R) \u2212 PR"}),". This results in an output vector ",(0,s.jsx)("code",{children:"Y"})," of unblinded messages, in completely shuffled order."]}),(0,s.jsxs)("p",{className:"pb-4 text-justify",children:["Calculation of a permutation matrix through a series of secret sharings first requires the calculation of a Beaver multiplication triple to perform multiplication (denoted as ",(0,s.jsx)("code",{children:"Mul(x, y)"}),"):"]}),(0,s.jsxs)("div",{className:"p-6 my-6 block rounded-xl dark:bg-white/10 bg-pink-50 border border-white/20 drop-shadow-xl",children:[(0,s.jsx)("div",{children:"Offline Calculation of Permutation Matrix Sharings:"}),(0,s.jsxs)("ol",{className:"list-decimal pl-6",children:[(0,s.jsxs)("li",{children:["All parties generate a ",(0,s.jsx)("code",{children:"k \xd7 k"})," permutation matrix ",(0,s.jsxs)("code",{children:["M",(0,s.jsx)("sub",{children:"i"})]})," and generates secret sharings, distributing to each party"]}),(0,s.jsx)("li",{children:"All parties verify the columns and rows of each sharing using sketch checks to verify the sharings correspond to a valid permutation matrix, aborting if a check fails."}),(0,s.jsxs)("li",{children:["All parties multiply their received matrix shares and their own share of their matrix, ",(0,s.jsxs)("code",{children:["\u27e8P\u27e9 = \u27e8M",(0,s.jsx)("sub",{children:"1"}),"\u27e9\u27e8M",(0,s.jsx)("sub",{children:"2"}),"\u27e9...\u27e8M",(0,s.jsx)("sub",{children:"n"}),"\u27e9"]})]}),(0,s.jsxs)("li",{children:["All parties generate k random shares, producing the vector ",(0,s.jsxs)("code",{children:["\u27e8R\u27e9 = ","{","\u27e8r",(0,s.jsx)("sub",{children:"1"}),"\u27e9,\u27e8r",(0,s.jsx)("sub",{children:"2"}),"\u27e9, ...,\u27e8r",(0,s.jsx)("sub",{children:"k"}),"\u27e9","}"]})]}),(0,s.jsxs)("li",{children:["All parties compute ",(0,s.jsx)("code",{children:"\u27e8P R\u27e9, = Mul(\u27e8P\u27e9,\u27e8R\u27e9)"})]})]})]}),(0,s.jsx)("p",{className:"pt-4 text-justify",children:"The online combination phase follows:"}),(0,s.jsxs)("div",{className:"p-6 my-6 block rounded-xl dark:bg-white/10 bg-pink-50 border border-white/20 drop-shadow-xl",children:[(0,s.jsx)("div",{children:"Online Matrix Permutation Recombination:"}),(0,s.jsxs)("ol",{className:"list-decimal pl-6",children:[(0,s.jsxs)("li",{children:["All parties receive blinded messages using chosen random shares, and are slotted into matching positions of the ",(0,s.jsx)("code",{children:"R"})," vector"]}),(0,s.jsxs)("li",{children:["All parties recombine the input vector, yielding ",(0,s.jsx)("code",{children:"X + R"}),"."]}),(0,s.jsxs)("li",{children:["All parties calculate ",(0,s.jsx)("code",{children:"\u27e8Y\u27e9 = \u27e8P\u27e9 \xb7 (X + R) \u2212 \u27e8PR\u27e9"}),", and then recombine to produce ",(0,s.jsx)("code",{children:"Y"}),"."]})]})]}),(0,s.jsx)("h2",{className:"text-xl pt-10 pb-4 font-medium",children:"Broadcast"}),(0,s.jsxs)("p",{className:"pb-4 text-justify",children:["All messages are broadcast, to be retrieved by their intended recipients, following ",(0,s.jsx)(o.N_,{to:"/docs/communication/gossip",children:"BlossomSub"}),"."]}),(0,s.jsx)("h2",{className:"text-xl pt-10 pb-4 font-medium",children:"Processing/Acknowledgement"}),(0,s.jsx)("p",{className:"pb-4 text-justify",children:"Messages are confirmed to destination, acknowledgement message is returned."}),(0,s.jsx)("h2",{className:"text-xl pt-10 pb-4 font-medium",children:"Transpose Mix"}),(0,s.jsx)("p",{className:"pb-4 text-justify",children:"The transpose of the permutation matrix shares is followed of the tagged acknowledgements, producing clean acknowledgements in the same order as client requests, allowing anonymous retrieval of confirmation."})]})})},l={sidebar_position:3},c="Mixnet Routing",d={id:"learn/communication/mixnet-routing",title:"Mixnet Routing",description:"",source:"@site/docs/learn/communication/mixnet-routing.md",sourceDirName:"learn/communication",slug:"/learn/communication/mixnet-routing",permalink:"/docs/learn/communication/mixnet-routing",draft:!1,unlisted:!1,editUrl:"https://github.com/QuilibriumNetwork/docs/tree/main/docs/learn/communication/mixnet-routing.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"learn",previous:{title:"E2EE",permalink:"/docs/learn/communication/e2ee"},next:{title:"P2P Communication",permalink:"/docs/learn/communication/p2p-communication"}},h={},m=[];function p(e){const t={h1:"h1",header:"header",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"mixnet-routing",children:"Mixnet Routing"})}),"\n",(0,s.jsx)(a,{})]})}function u(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},8453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>a});var s=i(6540);const n={},r=s.createContext(n);function o(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);