"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[841],{1253:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var i=t(4848),s=t(8453);const o={sidebar_position:3},r="RPC",a={id:"run-node/RPC",title:"RPC",description:"Remote Procedure Call support on Quilibrium allows hybridized offline-online mode, making management of common network assets (Accounts, Coins, Transactions) for more complex key management scenarios possible.",source:"@site/docs/run-node/RPC.md",sourceDirName:"run-node",slug:"/run-node/RPC",permalink:"/docs/run-node/RPC",draft:!1,unlisted:!1,editUrl:"https://github.com/QuilibriumNetwork/docs/tree/main/docs/run-node/RPC.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"run",previous:{title:"Advanced Configuration",permalink:"/docs/run-node/advanced-configuration"},next:{title:"Advanced Node Management",permalink:"/docs/run-node/advanced-node-management"}},c={},l=[{value:"Protobufs/Node RPC",id:"protobufsnode-rpc",level:2},{value:"Structure",id:"structure",level:3},{value:"Refs and AccountRefs",id:"refs-and-accountrefs",level:3},{value:"Request Envelopes",id:"request-envelopes",level:3},{value:"AccountService",id:"accountservice",level:3},{value:"Allow",id:"allow",level:4},{value:"GetBalance",id:"getbalance",level:4},{value:"ListCoins",id:"listcoins",level:4},{value:"ListPendingTransactions",id:"listpendingtransactions",level:4},{value:"Revoke",id:"revoke",level:4},{value:"CoinService",id:"coinservice",level:3},{value:"Allow",id:"allow-1",level:4},{value:"Intersect",id:"intersect",level:4},{value:"Merge",id:"merge",level:4},{value:"Mint",id:"mint",level:4},{value:"MutualReceive",id:"mutualreceive",level:4},{value:"MutualTransfer",id:"mutualtransfer",level:4},{value:"Revoke",id:"revoke-1",level:4},{value:"Split",id:"split",level:4},{value:"Transfer",id:"transfer",level:4},{value:"TransactionService",id:"transactionservice",level:4},{value:"Approve",id:"approve",level:4},{value:"Reject",id:"reject",level:4},{value:"Management Scenarios",id:"management-scenarios",level:2},{value:"Cold Custody",id:"cold-custody",level:3},{value:"Warm/Hot Custody",id:"warmhot-custody",level:3},{value:"MPC Custody",id:"mpc-custody",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"rpc",children:"RPC"})}),"\n",(0,i.jsx)(n.p,{children:"Remote Procedure Call support on Quilibrium allows hybridized offline-online mode, making management of common network assets (Accounts, Coins, Transactions) for more complex key management scenarios possible.\nThis document serves to capture both the raw RPC documentation following the protobufs, and then specific management scenarios for cold custody, warm/hot custody, and MPC custody."}),"\n",(0,i.jsx)(n.admonition,{type:"danger",children:(0,i.jsx)(n.p,{children:"It is critical to understand that in order to maintain the privacy of your account, that use of these RPCs is kept within secure trust boundaries \u2013 do not use an RPC server you do not control, and ensure that your connection to this RPC is secure and encrypted."})}),"\n",(0,i.jsx)(n.h2,{id:"protobufsnode-rpc",children:"Protobufs/Node RPC"}),"\n",(0,i.jsx)(n.h3,{id:"structure",children:"Structure"}),"\n",(0,i.jsxs)(n.p,{children:["Node RPC services take the form of the primary entity being interacted with, followed by Service.\nThe RPCs under the service are the names of the operations themselves, expecting a message named ",(0,i.jsx)(n.code,{children:"Decryptable<Operation><Entity>Request"})," as the argument.\nThe response message name follows the format of ",(0,i.jsx)(n.code,{children:"<Operation><Entity>Response"}),".\nIf an operation requires inputs from multiple parties and must follow stages, the response type is a stream to encapsulate the state changes as expected messages."]}),"\n",(0,i.jsx)(n.h3,{id:"refs-and-accountrefs",children:"Refs and AccountRefs"}),"\n",(0,i.jsx)(n.p,{children:'Generally, Ref types are simply hypergraph references by address, with the exception of AccountRefs, which have a special consideration in being either originated (e.g. created as an explicit entity on the network and referenced like any other Ref) or implicit (e.g. bound to and derived from a specific key and key type).\nThe latter is important for many "cold" key management operations, where a key is generated and lives completely offline from the network, restored only to perform operations such that all resources allocated to the key material has been transferred to another key, either cold or under a different custodial strategy.'}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message OriginatedAccountRef {\n  bytes address = 1;\n}\n \nmessage ImplicitAccount {\n  uint32 implicit_type = 1;\n  bytes address = 2;\n  bytes domain = 3;\n}\n \nmessage AccountRef {\n  oneof account {\n    OriginatedAccountRef originated_account = 1;\n    ImplicitAccount implicit_account = 2;\n  }\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["In the ",(0,i.jsx)(n.code,{children:"ImplicitAccount"})," case, the type specifier indicates the kind of implicit account it is, with 0 being a default key-derived account (Poseidon-hashed raw public key), 1 being a WebAuthN-derived account (Poseidon-hashed raw public key), which requires the corresponding domain name for validation scope.\nThe type leaves room for additional key/signature support in the future."]}),"\n",(0,i.jsx)(n.h3,{id:"request-envelopes",children:"Request Envelopes"}),"\n",(0,i.jsx)(n.p,{children:"Because data on Quilibrium is encrypted, and general network operations can only be conducted with the requisite key material to perform decryption as part of the operations, RPC methods mirror the actual application methods, but have a wrapper message for the caller to provide relevant information to perform the actual network interaction.\nStructurally, the request envelopes contain the request itself, a keyring collection, and optionally, if the request produces side effects regarding key management, the delivery strategy for communicating these updates:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message Decryptable<Operation><Entity>Request {\n  <Operation><Entity>Request request = 1;\n  KeyRing key_ring = 2;\n  DeliveryMethod delivery_method = 3;\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"The key ring is simply a collection of relevant keys: most importantly, the decryption keys for referenced assets.\nIn the event mutations on those given assets are performed, the reference takes a transactional lock."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message InlineKey {\n  bytes ref = 1;\n  bytes key = 2;\n}\n \nmessage KeyRing {\n  repeated InlineKey keys = 1;\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Delivery method indicates the delivery strategy, where the default type, 0, specifies normal inbox-driven delivery for all notifiable parties of key updates and additions.\nIf type is 1, it is the omission of deliveries.\nTo ensure network consistency and that it is not possible to induce an inaccessible state for relevant parties, the\nrelevant keys for all notifiable parties ",(0,i.jsx)(n.strong,{children:"must"})," be provided in the key ring.\nAddress is used to disambiguate the sender in the event multiple identifiable parties are present in the key ring."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message DeliveryMethod {\n  uint32 delivery_type = 1;\n  bytes address = 2;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"accountservice",children:"AccountService"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"quilibrium.node.node.pb.AccountService"})," RPC exposes a few simple operations for common account management:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"service AccountService {\n  rpc Allow(DecryptableAllowAccountRequest) returns (AllowAccountResponse);\n  rpc GetBalance(DecryptableBalanceAccountRequest) returns (BalanceAccountResponse);\n  rpc ListCoins(DecryptableCoinsAccountRequest) returns (CoinsAccountResponse);\n  rpc ListPendingTransactions(DecryptablePendingTransactionsAccountRequest) returns (PendingTransactionsAccountResponse);\n  rpc Revoke(DecryptableRevokeAccountRequest) returns (RevokeAccountResponse);\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"allow",children:"Allow"}),"\n",(0,i.jsxs)(n.p,{children:["Allows another account to perform actions on behalf of a given account. Returns the new ",(0,i.jsx)(n.code,{children:"AccountAllowanceRef"})," created and notifications delivered."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message AllowAccountRequest {\n  AccountRef of_account = 1;\n  AccountRef permitted_account = 2;\n  repeated string permitted_operations = 3;\n  AccountAllowanceRef allowance = 4;\n  Signature signature = 5;\n}\n \nmessage DecryptableAllowAccountRequest {\n  AllowAccountRequest request = 1;\n  KeyRing key_ring = 2;\n  DeliveryMethod delivery_method = 3;\n}\n \nmessage AllowAccountResponse {\n  AccountAllowanceRef allowance = 1;\n  repeated DeliveryData deliveries = 2;\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"getbalance",children:"GetBalance"}),"\n",(0,i.jsxs)(n.p,{children:["Requests the total balance of all ",(0,i.jsx)(n.code,{children:"Coins"})," directly under an account (not including those the account only has\nallowances over)."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message BalanceAccountRequest {\n  AccountRef account = 1;\n  AccountAllowanceRef allowance = 2;\n  Signature signature = 3;\n}\n \nmessage DecryptableBalanceAccountRequest {\n  BalanceAccountRequest request = 1;\n  KeyRing key_ring = 2;\n}\n \nmessage BalanceAccountResponse {\n  bytes balance = 1;\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"listcoins",children:"ListCoins"}),"\n",(0,i.jsxs)(n.p,{children:["Requests the set of all ",(0,i.jsx)(n.code,{children:"Coins"})," directly under an account (including those the account only has allowances over)."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message CoinInfo {\n  CoinRef coin = 1;\n  bytes balance = 2;\n}\n \nmessage CoinsAccountRequest {\n  AccountRef account = 1;\n  AccountAllowanceRef allowance = 2;\n  Signature signature = 3;\n}\n \nmessage DecryptableCoinsAccountRequest {\n  CoinsAccountRequest request = 1;\n  KeyRing key_ring = 2;\n}\n \nmessage CoinsAccountResponse {\n  repeated CoinInfo coins = 1;\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"listpendingtransactions",children:"ListPendingTransactions"}),"\n",(0,i.jsxs)(n.p,{children:["Requests the set of all ",(0,i.jsx)(n.code,{children:"PendingTransactions"})," directly under an account."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message PendingTransactionsAccountRequest {\n  AccountRef account = 1;\n  AccountAllowanceRef allowance = 2;\n  Signature signature = 3;\n}\n \nmessage DecryptablePendingTransactionsAccountRequest {\n  PendingTransactionsAccountRequest request = 1;\n  KeyRing key_ring = 2;\n  DeliveryMethod delivery_method = 3;\n}\n \nmessage PendingTransactionInfo {\n  PendingTransactionRef pending_transaction = 1;\n  CoinInfo coin = 2;\n  AccountRef refund_account = 3;\n}\n \nmessage PendingTransactionsAccountResponse {\n  repeated PendingTransactionInfo pending_transactions = 1;\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"revoke",children:"Revoke"}),"\n",(0,i.jsxs)(n.p,{children:["Revokes the provided ",(0,i.jsx)(n.code,{children:"AccountAllowance"})," by reference."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message RevokeAccountRequest {\n  AccountRef of_account = 1;\n  AccountAllowanceRef revoked_allowance = 2;\n  AccountAllowanceRef allowance = 3;\n  Signature signature = 4;\n}\n \nmessage DecryptableRevokeAccountRequest {\n  RevokeAccountRequest request = 1;\n  KeyRing key_ring = 2;\n  DeliveryMethod delivery_method = 3;\n}\n \nmessage RevokeAccountResponse {\n  repeated DeliveryData deliveries = 1;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"coinservice",children:"CoinService"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"quilibrium.node.node.pb.CoinService"})," RPC exposes a few simple operations for common coin management:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"service CoinService {\n  rpc Allow(DecryptableAllowCoinRequest) returns (AllowCoinResponse);\n  rpc Intersect(DecryptableIntersectCoinRequest) returns (IntersectCoinResponse);\n  rpc Merge(DecryptableMergeCoinRequest) returns (MergeCoinResponse);\n  rpc Mint(DecryptableMintCoinRequest) returns (MintCoinResponse);\n  rpc MutualReceive(DecryptableMutualReceiveCoinRequest) returns (stream MutualReceiveCoinResponse);\n  rpc MutualTransfer(DecryptableMutualTransferCoinRequest) returns (stream MutualTransferCoinResponse);\n  rpc Revoke(DecryptableRevokeCoinRequest) returns (RevokeCoinResponse);\n  rpc Split(DecryptableSplitCoinRequest) returns (SplitCoinResponse);\n  rpc Transfer(DecryptableTransferCoinRequest) returns (TransferCoinResponse);\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"allow-1",children:"Allow"}),"\n",(0,i.jsxs)(n.p,{children:["Allows another account to perform actions on behalf of a given ",(0,i.jsx)(n.code,{children:"Coin"}),".\nReturns the new ",(0,i.jsx)(n.code,{children:"CoinAllowanceRef"})," created and notifications delivered."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message AllowCoinRequest {\n  CoinRef of_coin = 1;\n  AccountRef permitted_account = 2;\n  repeated string permitted_operations = 3;\n  AccountAllowanceRef account_allowance = 4;\n  CoinAllowanceRef coin_allowance = 5;\n  Signature signature = 6;\n}\n \nmessage DecryptableAllowCoinRequest {\n  AllowCoinRequest request = 1;\n  KeyRing key_ring = 2;\n  DeliveryMethod delivery_method = 3;\n}\n \nmessage AllowCoinResponse {\n  CoinAllowanceRef allowance = 1;\n  repeated DeliveryData deliveries = 2;\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"intersect",children:"Intersect"}),"\n",(0,i.jsxs)(n.p,{children:["Performs a set intersection evaluation on a given ",(0,i.jsx)(n.code,{children:"Coin"}),".\nReturns a boolean value indicating whether or not the provided addresses appeared in the intersection data."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message IntersectCoinRequest {\n  repeated bytes addresses = 1;\n  AccountAllowanceRef account_allowance = 2;\n  CoinAllowanceRef coin_allowance = 3;\n  CoinRef of_coin = 4;\n}\n \nmessage DecryptableIntersectCoinRequest {\n  IntersectCoinRequest request = 1;\n  KeyRing key_ring = 2;\n  DeliveryMethod delivery_method = 3;\n}\n \nmessage IntersectCoinResponse {\n  bool intersects = 1;\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"merge",children:"Merge"}),"\n",(0,i.jsxs)(n.p,{children:["Merges a collection of ",(0,i.jsx)(n.code,{children:"CoinRefs"})," into a single ",(0,i.jsx)(n.code,{children:"Coin"}),".\nNote: Merging combines the intersection data of the ",(0,i.jsx)(n.code,{children:"Coin"}),"s."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message MergeCoinRequest {\n  repeated CoinRef coins = 1;\n  AccountAllowanceRef account_allowance = 2;\n  repeated CoinAllowanceRef coin_allowances = 3;\n  Signature signature = 4;\n}\n \nmessage DecryptableMergeCoinRequest {\n  MergeCoinRequest request = 1;\n  KeyRing key_ring = 2;\n  DeliveryMethod delivery_method = 3;\n}\n \nmessage MergeCoinResponse {\n  CoinRef coin = 1;\n  repeated DeliveryData deliveries = 2;\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mint",children:"Mint"}),"\n",(0,i.jsxs)(n.p,{children:["Mints ",(0,i.jsx)(n.code,{children:"Coin"}),"s based on the provided proofs from the protocol.\nUnless the node is explicitly configured to not auto claim, this is handled automatically."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message MintCoinRequest {\n  repeated bytes proofs = 1;\n  AccountAllowanceRef allowance = 2;\n  Signature signature = 3;\n}\n \nmessage DecryptableMintCoinRequest {\n  MintCoinRequest request = 1;\n  KeyRing key_ring = 2;\n  DeliveryMethod delivery_method = 3;\n}\n \nmessage MintCoinResponse {\n  repeated CoinInfo coins = 1;\n  repeated DeliveryData deliveries = 2;\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mutualreceive",children:"MutualReceive"}),"\n",(0,i.jsxs)(n.p,{children:["The recipient side of a live mutual transfer process.\nReturns a stream of messages indicating status of the transfer process, initiated ",(0,i.jsx)(n.code,{children:"rendezvous"})," string (which must be provided to the sender), the received ",(0,i.jsx)(n.code,{children:"CoinRef"})," and relevant deliveries."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message MutualReceiveCoinRequest {\n  AccountRef to_account = 1;\n  AccountAllowanceRef allowance = 2;\n  Signature signature = 3;\n}\n \nmessage DecryptableMutualReceiveCoinRequest {\n  MutualReceiveCoinRequest request = 1;\n  KeyRing key_ring = 2;\n  DeliveryMethod delivery_method = 3;\n}\n \nmessage MutualReceiveCoinResponse {\n  uint32 status = 1;\n  bytes rendezvous = 2;\n  CoinRef coin = 3;\n  repeated DeliveryData deliveries = 4;\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mutualtransfer",children:"MutualTransfer"}),"\n",(0,i.jsxs)(n.p,{children:["The sender side of a provided ",(0,i.jsx)(n.code,{children:"CoinRef"})," in a live mutual transfer process.\nReturns a stream of messages indicating status of the transfer process, and relevant deliveries."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message MutualTransferCoinRequest {\n  bytes rendezvous = 1;\n  CoinRef of_coin = 2;\n  AccountAllowanceRef account_allowance = 3;\n  CoinAllowanceRef coin_allowance = 4;\n  Signature signature = 5;\n}\n \nmessage DecryptableMutualTransferCoinRequest {\n  MutualTransferCoinRequest request = 1;\n  KeyRing key_ring = 2;\n  DeliveryMethod delivery_method = 3;\n}\n \nmessage MutualTransferCoinResponse {\n  uint32 status = 1;\n  repeated DeliveryData deliveries = 2;\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"revoke-1",children:"Revoke"}),"\n",(0,i.jsxs)(n.p,{children:["Revokes a provided ",(0,i.jsx)(n.code,{children:"CoinAllowanceRef"})," for the given ",(0,i.jsx)(n.code,{children:"CoinRef"}),".\nReturns relevant deliveries."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message RevokeCoinRequest {\n  CoinRef of_coin = 1;\n  CoinAllowanceRef revoked_allowance = 2;\n  AccountAllowanceRef account_allowance = 3;\n  CoinAllowanceRef coin_allowance = 4;\n  Signature signature = 5;\n}\n \nmessage DecryptableRevokeCoinRequest {\n  RevokeCoinRequest request = 1;\n  KeyRing key_ring = 2;\n  DeliveryMethod delivery_method = 3;\n}\n \nmessage RevokeCoinResponse {\n  repeated DeliveryData deliveries = 1;\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"split",children:"Split"}),"\n",(0,i.jsxs)(n.p,{children:["Splits a ",(0,i.jsx)(n.code,{children:"Coin"})," into given separate amounts, with optional parameters regarding permissions provided as needed to validate the split.\nReturns output ",(0,i.jsx)(n.code,{children:"CoinRef"}),"s and relevant deliveries."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message SplitCoinRequest {\n  CoinRef of_coin = 1;\n  repeated bytes amounts = 2;\n  AccountAllowanceRef account_allowance = 3;\n  CoinAllowanceRef coin_allowance = 4;\n  Signature signature = 5;\n}\n \nmessage DecryptableSplitCoinRequest {\n  SplitCoinRequest request = 1;\n  KeyRing key_ring = 2;\n  DeliveryMethod delivery_method = 3;\n}\n \nmessage SplitCoinResponse {\n  repeated CoinRef coins = 1;\n  repeated DeliveryData deliveries = 2;\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"transfer",children:"Transfer"}),"\n",(0,i.jsxs)(n.p,{children:["Initiates a transfer of a given ",(0,i.jsx)(n.code,{children:"Coin"})," to another ",(0,i.jsx)(n.code,{children:"Account"}),", with optional parameters regarding refund account, expiry of the transaction state, and permissions provided as needed to validate the transfer.\nReturns a pending transaction reference and relevant deliveries."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message TransferCoinRequest {\n  AccountRef to_account = 1;\n  AccountRef refund_account = 2;\n  CoinRef of_coin = 3;\n  int64 expiry = 4;\n  AccountAllowanceRef account_allowance = 5;\n  CoinAllowanceRef coin_allowance = 6;\n  Signature signature = 7;\n}\n \nmessage DecryptableTransferCoinRequest {\n  TransferCoinRequest request = 1;\n  KeyRing key_ring = 2;\n  DeliveryMethod delivery_method = 3;\n}\n \nmessage TransferCoinResponse {\n  PendingTransactionRef pending_transaction = 1;\n  repeated DeliveryData deliveries = 2;\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"transactionservice",children:"TransactionService"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"quilibrium.node.node.pb.TransactionService"})," RPC exposes a few simple operations for pending transaction management:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"service TransactionService {\n  rpc Approve(DecryptableApprovePendingTransactionRequest) returns (ApprovePendingTransactionResponse);\n  rpc Reject(DecryptableRejectPendingTransactionRequest) returns (RejectPendingTransactionResponse);\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"approve",children:"Approve"}),"\n",(0,i.jsxs)(n.p,{children:["Approves a pending transaction and returns the received ",(0,i.jsx)(n.code,{children:"CoinRef"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message ApprovePendingTransactionRequest {\n  PendingTransactionRef pending_transaction = 1;\n  AccountAllowanceRef account_allowance = 2;\n  Signature signature = 3;\n}\n \nmessage DecryptableApprovePendingTransactionRequest {\n  ApprovePendingTransactionRequest request = 1;\n  KeyRing key_ring = 2;\n  DeliveryMethod delivery_method = 3;\n}\n \nmessage ApprovePendingTransactionResponse {\n  CoinRef coin = 1;\n  repeated DeliveryData deliveries = 2;\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"reject",children:"Reject"}),"\n",(0,i.jsx)(n.p,{children:"Rejects a pending transaction."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"message RejectPendingTransactionRequest {\n  PendingTransactionRef pending_transaction = 1;\n  AccountAllowanceRef account_allowance = 2;\n  Signature signature = 3;\n}\n \nmessage DecryptableRejectPendingTransactionRequest {\n  RejectPendingTransactionRequest request = 1;\n  KeyRing key_ring = 2;\n  DeliveryMethod delivery_method = 3;\n}\n \nmessage RejectPendingTransactionResponse {\n  repeated DeliveryData deliveries = 2;\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"management-scenarios",children:"Management Scenarios"}),"\n",(0,i.jsx)(n.h3,{id:"cold-custody",children:"Cold Custody"}),"\n",(0,i.jsx)(n.p,{children:'Cold custody is a process which generally takes place in a secure airgapped environment, where key generation is controlled under a formally audited process, with secure custody management of the private key material, and either the raw public key or derivation information of the public key is provided, sometimes including additional data like a signature to prove key material was generated correctly.\nCold custody management scenarios typically consider any interaction with an online world to be a transition point where the key becomes classified as "warm" or "hot", and is no longer suitable for long term usage.\nFor cold custody operations, it is therefore advisable to have an account configuration of the following:'}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["The account to receive assets is an implicit account, of ",(0,i.jsx)(n.a,{href:"#refs-and-accountrefs",children:(0,i.jsx)(n.code,{children:"type 0"})}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["If desired to avoid users providing key info for the pending transaction, the initial signature should be a singular operation for the network, to permit a warm/hot key to perform at least ",(0,i.jsx)(n.a,{href:"#listpendingtransactions",children:(0,i.jsx)(n.code,{children:"ListPendingTransactions"})}),", which can be relayed via the RPC after the cold key production process is completed."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'AllowAccountRequest{\n  OfAccount: &AccountRef{\n    Account: &ImplicitAccount{\n      ImplicitType: 0,\n      Address: <derivedPoseidonHash>,\n    },\n  },\n  PermittedAccount: &AccountRef{\n    Account: <accountToGiveReadRights>,\n  },\n  PermittedOperations: []string{"account:ListPendingTransactions"},\n  Signature: &Signature{\n    SignatureType: 0,\n    Signature: <rawSigBytes>,\n    Key: &KeyRef{\n      Address: <derivedPoseidonHash>,\n    },\n  },\n}\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Then monitor ongoing pending transactions from the RPC using the permitted key."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"PendingTransactionsAccountRequest{\n  Account: &AccountRef{\n    Account: &ImplicitAccount{\n      ImplicitType: 0,\n      Address: <derivedPoseidonHash>,\n    },\n  },\n  Allowance: &AccountAllowanceRef{\n    Address: <addressOfAllowance>,\n  },\n  Signature: <signatureOfAccountGivenRights>,\n}\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"When the cold key is desired to come online, it can be used with the subsequent accept/reject operation, and then\ntransfer or mutual transfer operations."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"warmhot-custody",children:"Warm/Hot Custody"}),"\n",(0,i.jsxs)(n.p,{children:["Warm/Hot custody operations are more straightforward in comparison, but generally there are important limits to be concerned with in terms of assets under the custody of the key.\nIn this case, accepting and rejecting the pending transactions is a matter of ongoing operations, unless the mutual transfer scenario is desired.\nThe other RPC that will typically be important for monitoring is the ",(0,i.jsx)(n.a,{href:"#getbalance",children:(0,i.jsx)(n.code,{children:"GetBalance"})})," and ",(0,i.jsx)(n.a,{href:"#listcoins",children:(0,i.jsx)(n.code,{children:"ListCoins"})})," operations."]}),"\n",(0,i.jsx)(n.h3,{id:"mpc-custody",children:"MPC Custody"}),"\n",(0,i.jsxs)(n.p,{children:["MPC custodial operations traditionally perform signatures entirely within the infrastructure of the custodian, but if there are circumstances where this is not desired, you can utilize the network's Key Management application to perform MPC signing over the network, across two or more parties.\nThe output key generated can subsequently be used as an ",(0,i.jsx)(n.a,{href:"#refs-and-accountrefs",children:(0,i.jsx)(n.code,{children:"ImplicitAccount"})})," for the relevant\noperations previously\noutlined."]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var i=t(6540);const s={},o=i.createContext(s);function r(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);